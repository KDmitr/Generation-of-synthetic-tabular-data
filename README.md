# Generation-of-synthetic-tabular-data

### **Валидация структурированного вывода LLM**
Эксперименты проводились на двух датасетах: Beijing (10 признаков), Forest (55 признаков); использовались LLM: LLAMA-3.3-70B-instruct, LLAMA-3.1-70B-instruct, LLAMA-3.1-8B-instruct и Deepseek-r1-8b; разный размер батча: 5,10 и 2 (для deepseek на forest, т.к. с большим размером батча модель не может работать).\
Выводы:
* Данные генерируется нужного формата: список JSON
* Метрики все считаются (за исключением некоторых эксперементов с Deepseek-r1-8b)
* Deepseek выдаёт относительно неплохие результаты относительно других моделей на небольшом датасете (10 признаков), но на большом датасете (55 признаков) качество у deepseek резко падает
* Модели LLAMA более устойчивы к размеру датасета, т.е. показывают высокие показатели качества как на маленьких, так и на больших датасетах
* Лучшая из используемых LLM - LLAMA-3.1-70B-instruct
* Изменение размера батча (количество строк) не влияет на качество
* у Deepseek были галлюцинации: 
    * на датасете Beijing модель придумала новые столбцы "Day" и "Hour" и заполнила все значения в этих столбцах NaN. Когда проделал ещё раз этот же эксперимент, этого уже не было.
     * на датасете Forest: есть строки, состоящие только из Nan, появились неведомые столбцы "id" и "data",  и в "data" есть странные не имеющие смысла значения в виде словарей

||Without|	Deepseek-r1|	GPT-4o|	LLAMA-3.1-72b-instruct|
|----|---|----|----|----|
|data_mismatch|	0.0|	0.0|	0.0|	0.0|
common_rows_proportion|	0.014667|	0.022667|	0.052|	0.009333
nearest_syn_neighbor_distance|**0.303269**|	0.266986|	0.254076|	0.225375|
close_values_probability|	0.312|	0.388|	0.426667|	0.536
distant_values_probability|	0.032|	0.02|	**0.010667**|	0.013333
Kolmogorov-Smirnov test|	0.871467|	**0.905333**|	0.8968|	0.8872
inverse Kullback–Leibler Divergence|	0.728445|	0.710322|	0.679427|	**0.760823**
chi_squared_test|	**0.627966**|	0.479694|	0.319559|	0.519174
Jensen-Shannon distance|	0.015689|	**0.011385**	|0.012003|	0.013278
Maximum Mean Discrepancy	|0.039361|	**0.020325**|	0.025768|	0.02476
precision	|0.874667|	0.929333|	0.910667|	**0.945333**
recall	|0.92|	0.910667|	0.92|	0.928
density	|0.890133|	**1.049867**|	1.004|	1.0072
coverage|	0.861333|	**0.936**|	0.922667|	0.929333|
lin_r2_s|	0.923404|	0.923404|	0.923404|	0.923404
lin_syn_id|	0.907263|	**0.922354**|	0.919646|	0.912392
lin_syn_ood	|0.906271	|**0.92138**|	0.91867|	0.911298
xgb_gt_r2|	0.930716|	0.930716	|0.930716|	0.930716
xgb_syn_id_r2|	0.88593|	**0.916775**|	0.890265|	0.916686|
xgb_syn_ood_r2|	0.88457|	0.915485	|0.88892|	**0.915738**|


||Without|	Deepseek-r1|	GPT-4o|	LLAMA-3.1-72b-instruct|
|--|--|---|---|---|
data_mismatch|0.0	|0.0	|0.0|	0.0
common_rows_proportion|	0.106667|	0.144|	0.145333|	0.186667|
nearest_syn_neighbor_distance|	0.334767|	0.30859|	0.264809|	0.223197
close_values_probability|	0.196	|0.226667|	0.32|	0.466667
distant_values_probability|	0.029333|	0.026667|	**0.017333**	|**0.017333**|
Kolmogorov-Smirnov test	|0.9448|**0.949333**|	0.942648|	0.937867
inverse Kullback–Leibler Divergence|	**0.914273**|	0.900315|	0.891021|	0.807612
chi_squared_test|	0.719902|	0.679788	|**0.759633**	|0.519604
Jensen-Shannon distance|	0.00663|	**0.006445**|	0.007408|	0.007964
Maximum Mean Discrepancy|	0.00297|**0.002879**|	0.003848|	0.007319
precision|	0.988|**0.990667**|	0.984857|	0.989333
recall|	**0.985333**|	0.973333|	0.973333|	0.934667
density|	1.101333|	1.1192|	1.115676|**1.133067**
coverage|	0.996|**0.998667**|	0.994667|	0.982667
lin_r2_s|	0.923404|	0.923404|	0.923404|	0.923404
lin_syn_id	|0.928261	|**0.928338**|	0.927861|	0.925137
lin_syn_ood|	0.927206|**0.927352**|	0.926806|	0.924097
xgb_gt_r2|	0.930716|	0.930716|	0.930716|	0.930716
xgb_syn_id_r2|	0.934741|	**0.94195**	|0.93973|	0.935961
xgb_syn_ood_r2|	0.933668|	**0.941239**|	0.939453|	0.934843


|	|Without|	GPT-4o|	LLAMA-3.1-72b-instruct|
|--|--|---|---|
data_mismatch|	0.0|	0.0	|0.0
common_rows_proportion	|0.003333|	0.02|	0.033333
nearest_syn_neighbor_distance|	0.348773|	0.318267|	0.362128
close_values_probability|	0.116667|	0.14|	0.126667
distant_values_probability	|0.026667|	**0.006667**|	0.033333
Kolmogorov-Smirnov test|	0.868|	**0.892364**|	0.863333
inverse Kullback–Leibler Divergence|	0.840143|	0.744379|	**0.874877**
chi_squared_test|	0.896112|	0.599955|	**0.999184**
Jensen-Shannon distance	|0.016241	|0.013316	|0.015096
Maximum Mean Discrepancy	|0.068094|	**0.034311**|	0.070722
precision|	0.431818|	**0.609091**|	0.4625
recall	|0.99|	0.96|	**1.0**
density	|0.218182|	**0.434545**|	0.3075
coverage|	0.466667|	**0.593333**|	0.513333
lin_r2_s|	0.923404|	0.923404|	0.923404
lin_syn_id|	0.853269|	**0.888167**|	0.842086
lin_syn_ood	|0.852319	|**0.887331**	|0.840877
xgb_gt_r2|	0.930716|	0.930716|	0.930716
xgb_syn_id_r2|	0.429099|	0.735492|	**0.753528**
xgb_syn_ood_r2	|0.425383|	0.733645|	**0.749495**


||LLAMA+Deepseek|Qwen+Deepseek|	CTGAN|TVAE|GANBLR|RTVAE|GANBLR++|
|--|--|---|---|---|---|---|---|
data_mismatch|0.0	|0.0	|0.0|0.0|0.0|0.0|0.0
common_rows_proportion|	0.022667|	0.144|0.0|0.0|0.0|0.0|0.0	
nearest_syn_neighbor_distance|	0.266986|	0.30859|0.430425|0.36826|0.493368|0.36081|0.391814	
close_values_probability|	0.388	|0.226667|	0.41333|0.3466|0.13999|0.36666|0.36
distant_values_probability|	0.02|	0.026667|	0.33999|0.0933|0.14666|0.033333|0.1
Kolmogorov-Smirnov test	|0.905333|**0.949333**|	0.358666|0.66933|0.785333|0.506666|0.701333
inverse Kullback–Leibler Divergence|	0.728445|	0.900315|0.12638|0.345652|0.51494|0.24303|0.50046	
chi_squared_test|	0.627966|	0.679788| 0.01876|0.19322|0.39707|0.191141|0.47759	
Jensen-Shannon distance|	0.015689|	**0.006445**|0.066152|0.03684|0.0288|0.06136|0.03688
Maximum Mean Discrepancy|	0.039361|**0.002879**|	0.471078|0.139513|0.19363|0.22549|0.22919
precision|	0.929333|**0.990667**|	0.95333|0.65999|0.27333|0.79333|0.14666
recall|	0.92|	0.973333|	0.59333|0.98|1.0|0.78666|0.48666
density|	1.049867|	1.1192|	0.98|0.656|0.12533|0.94533|0.04666
coverage|	0.936|**0.998667**|	0.32|0.6599|0.3333|0.53333|0.173333
lin_r2_s|	0.923404|	0.923404|0.9770833|0.9770833|0.9770833|0.977083|0.977083		
lin_syn_id	|0.922354	|0.928338|	0.8765625|0.885416|0.84843|0.8770833|**0.940104**
lin_syn_ood|	0.92138|0.927352|0.92222|0.888888|0.8777|0.830555|**0.95**
xgb_gt_r2|	0.930716|	0.930716|	0.93645|0.93645|0.93645|0.93645|0.93645|
xgb_syn_id_r2|	0.916775|	0.94195	|0.52777|0.85833|0.891145|0.726041|**0.95156**
xgb_syn_ood_r2|	0.915485|	**0.941239**|0.66111|0.86944|0.908333|0.675|0.93611	
